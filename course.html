<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Course - VetriLearnX</title>
  <link rel="stylesheet" href="CSS/style.css" />
  
  <style>
    .course-layout {
      display: grid;
      grid-template-columns: 320px 1fr;
      min-height: calc(100vh - 64px);
      gap: 0;
    }

    @media (max-width: 960px) {
      .course-layout {
        grid-template-columns: 1fr;
      }
    }

    /* Curriculum (left) */
    .curriculum {
      background: rgba(0, 0, 0, 0.35);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(255, 255, 255, 0.15);
      overflow-y: auto;
      padding: 12px;
    }

    .course-header {
      padding: 10px 12px;
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 8px;
      margin-bottom: 12px;
      background: rgba(255, 255, 255, 0.1);
    }

    .course-header h2 {
      font-size: 1.1rem;
      margin-bottom: 6px;
    }

    .section {
      margin-bottom: 14px;
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 8px;
      overflow: hidden;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(255, 255, 255, 0.12);
      padding: 10px 12px;
      cursor: pointer;
      user-select: none;
    }

    .section-header span {
      font-weight: 600;
    }

    .lessons {
      display: grid;
    }

    .lesson {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      background: rgba(255, 255, 255, 0.06);
      border-top: 1px solid rgba(255, 255, 255, 0.08);
      cursor: pointer;
    }

    .lesson .index {
      font-size: 12px;
      opacity: 0.8;
      min-width: 22px;
      text-align: right;
    }

    .lesson .title {
      font-size: 0.95rem;
      flex: 1;
    }

    .lesson .duration {
      font-size: 12px;
      opacity: 0.8;
    }

    .lesson .state {
      font-size: 11px;
      padding: 2px 6px;
      border-radius: 10px;
      background: #ff00cc;
      opacity: 0.9;
    }

    .lesson.active {
      background: rgba(255, 255, 255, 0.18);
    }

    .lesson.completed {
      background: rgba(0, 200, 120, 0.18);
    }

    .lesson.locked {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Player (right) */
    .player-area {
      padding: 16px;
      display: grid;
      gap: 16px;
    }

    .video-wrapper {
      width: 100%;
      background: #000;
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    video {
      width: 100%;
      height: auto;
      display: block;
      max-height: 65vh;
      background: #000;
    }

    .player-actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }

    .player-actions .spacer {
      flex: 1;
    }

    .player-actions button {
      padding: 8px 12px;
      border: none;
      border-radius: 6px;
      color: #fff;
      background: linear-gradient(45deg, #ff00cc, #3333ff);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .player-actions button.primary {
      background: linear-gradient(45deg, #00d084, #14b8a6);
    }

    .player-actions button.accent {
      background: linear-gradient(45deg, #f59e0b, #f97316);
    }

    .player-actions button:hover {
      transform: translateY(-2px);
    }

    .course-progress {
      display: grid;
      gap: 8px;
    }

    .progress-label {
      font-size: 0.95rem;
    }

    .progress-bar {
      width: 100%;
      height: 10px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      overflow: hidden;
    }

    #progressFill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #00d084, #14b8a6);
      transition: width 0.35s ease;
    }

    .certificate-area {
      display: flex;
      justify-content: flex-start;
    }

    .lesson-meta h2 {
      margin-bottom: 6px;
    }

    .lesson-meta p {
      opacity: 0.9;
    }

    /* Small helpers */
    .course-title {
      margin-left: 8px;
      font-weight: 600;
    }

    .user-pill {
      margin-left: auto;
      margin-right: 8px;
      padding: 4px 10px;
      border-radius: 14px;
      font-size: 0.9rem;
      background: rgba(255, 255, 255, 0.12);
    }

    #ytFrame { width: 100%; height: 56.25vw; max-height: 65vh; }
@media (min-width: 900px) { #ytFrame { height: 480px; } }
  </style>
</head>

<body> <!-- Navbar (kept from your theme) -->
  <header class="navbar"> <a href="index.html" class="logo">ðŸ“˜ VetriLearnX</a>
    <div class="course-title" id="courseTitle">Course</div>
    <div class="user-pill" id="userPill"></div> <a href="cart.html" class="nav-link">ðŸ›’ Cart</a> <button
      id="themeToggle">ðŸŒ™</button>
  </header> <!-- Optional waves/shapes: keep if you like the accent -->
  <div class="wave wave-top"> <svg viewBox="0 0 1440 320" preserveAspectRatio="none">
      <path fill="#ff00cc" fill-opacity="0.7"
        d="M0,64L48,80C96,96,192,128,288,122.7C384,117,480,75,576,85.3C672,96,768,160,864,186.7C960,213,1056,203,1152,165.3C1248,128,1344,64,1392,32L1440,0L1440,320L0,320Z">
      </path>
    </svg> </div>
  <div class="shapes">
    <div class="circle"></div>
    <div class="triangle"></div>
    <div class="square"></div>
  </div>
  <main class="course-layout"> <!-- Left: Curriculum -->
    <aside class="curriculum">
      <div class="course-header">
        <h2 id="sidebarCourseName">Course</h2>
        <div>Instructor: <span id="sidebarInstructor">â€”</span></div>
        <div>Total lessons: <span id="sidebarCount">0</span></div>
      </div>
      <div id="curriculum"><!-- sections/lessons injected by JS --></div>
    </aside>

    <!-- Right: Player -->
    <section class="player-area">
   <div class="video-wrapper"> <video id="video" controls playsinline></video> </div>

      <div class="player-actions">
     
        <div class="spacer"></div>
        <button id="prevBtn">â¬… Prev</button>
        <button id="nextBtn">Next âž¡</button>
      </div>

      <div class="course-progress">
        <div class="progress-label">
          Progress: <span id="progressText">0%</span>
        </div>
        <div class="progress-bar">
          <div id="progressFill"></div>
        </div>
      </div>

      <div id="certificateArea" class="certificate-area" style="display:none;">
        <button id="downloadCertBtn" class="accent">Download Certificate ðŸŽ“</button>
      </div>

      <div class="lesson-meta">
        <h2 id="lessonTitle">Lesson title</h2>
        <p id="lessonDesc">Lesson description...</p>
      </div>
    </section>
  </main> <!-- Bottom wave -->
  <div class="wave wave-bottom"> <svg viewBox="0 0 1440 320" preserveAspectRatio="none">
      <path fill="#3333ff" fill-opacity="0.8"
        d="M0,160L60,176C120,192,240,224,360,240C480,256,600,256,720,250.7C840,245,960,235,1080,202.7C1200,171,1320,117,1380,90.7L1440,64L1440,320L0,320Z">
      </path>
    </svg> </div> <!-- Your global JS (theme toggle etc.) -->
    <script src="JS/auth.js"></script>
  <script src="JS/script.js"></script> 
  
  <!-- Page-specific logic -->
 <!-- Page-specific logic -->
<script> 
if (!localStorage.getItem('lxCurrentUser')) {
location.href = 'login.html';
}

const $ = (s, root = document) => root.querySelector(s);
 const $$ = (s, root = document) => Array.from(root.querySelectorAll(s)); 
 const params = new URLSearchParams(location.search); 
 const courseName = params.get('course') || 'Course';
  const username = localStorage.getItem('lxUserName');
   const STORAGE_KEY = (name) => `lxCourseProgress::${name}`; 
   const COURSE_LIBRARY = { 'Python Basics': {
instructor: 'Alice',
sections: [
{
title: 'Introduction',
lessons: [
{ id: 'py-1', type: 'mp4', title: 'Welcome to the Course', duration: '02:10', src: 'Videos/sample1.mp4', desc: 'Overview of Python Basics.' },
{ id: 'py-2', type: 'mp4', title: 'Setup & Tools', duration: '04:30', src: 'Videos/sample2.mp4', desc: 'Installing Python and IDE.' }
]
},
{
title: 'Core Concepts',
lessons: [
{ id: 'py-3', type: 'mp4', title: 'Variables & Types', duration: '05:45', src: 'Videos/sample3.mp4', desc: 'Primitive types and variables.' },
{ id: 'py-4', type: 'mp4', title: 'Control Flow', duration: '06:20', src: 'Videos/sample4.mp4', desc: 'If/else, loops.' }
]
}
]
}, 
      'UI/UX Design': { instructor: 'John Doe', sections: [ { title: 'Getting Started', lessons: [ 
        { id: 'ux-1', title: 'Design Mindset', duration: '03:00', src: 'Videos/sample1.mp4', 
        desc: 'What is UX/UI.' }, { id: 'ux-2', title: 'Tools Overview', duration: '03:40', src: 'Videos/sample2.mp4', 
        desc: 'Figma and more.' } ] }, { title: 'Practice', lessons: [ 
          { id: 'ux-3', title: 'Wireframes', duration: '05:00', src: 'Videos/sample3.mp4',
           desc: 'Low-fidelity design.' }, { id: 'ux-4', title: 'Prototypes', 
           duration: '06:20', src: 'Videos/sample4.mp4', desc: 'Interactive flows.' } ] } ] }, 
           'Data Analysis': { instructor: 'Veebha', sections: [ { title: 'Intro', lessons: [
             { id: 'da-1', title: 'What is DA?', duration: '02:30', src: 'Videos/sample1.mp4',
              desc: 'Data analysis overview.' }, { id: 'da-2', title: 'Data Types', duration: '04:00',
               src: 'Videos/sample2.mp4', desc: 'Structured vs unstructured.' } ] },
                { title: 'Hands-on', lessons: [ { id: 'da-3', title: 'Pandas 101', duration: '05:40', src: 'Videos/sample3.mp4', desc: 'DataFrames basics.' }, { id: 'da-4', title: 'Visualization', duration: '06:15', src: 'Videos/sample4.mp4', desc: 'Plotting techniques.' } ] } ] }, 'Animation Design': { instructor: 'Swetha', sections: [ { title: 'Start', lessons: [ { id: 'ad-1', title: 'Principles', duration: '03:10', src: 'Videos/sample1.mp4', desc: 'Fundamentals of animation.' }, { id: 'ad-2', title: 'Timing & Spacing', duration: '03:40', src: 'Videos/sample2.mp4', desc: 'Motion essentials.' } ] }, { title: 'Practice', lessons: [ { id: 'ad-3', title: 'Keyframes', duration: '05:30', src: 'Videos/sample3.mp4', desc: 'Animating with keyframes.' }, { id: 'ad-4', title: 'Export', duration: '04:30', src: 'Videos/sample4.mp4', desc: 'Formats and delivery.' } ] } ] }, 'AI Enhancement': { instructor: 'Parsi', sections: [ { title: 'Foundations', lessons: [ { id: 'ai-1', title: 'AI Landscape', duration: '03:00', src: 'Videos/sample1.mp4', desc: 'What is modern AI?' }, { id: 'ai-2', title: 'Key Concepts', duration: '04:10', src: 'Videos/sample2.mp4', desc: 'Models, data, training.' } ] }, { title: 'Apply', lessons: [ { id: 'ai-3', title: 'Enhancement Pipeline', duration: '05:20', src: 'Videos/sample3.mp4', desc: 'From idea to product.' }, { id: 'ai-4', title: 'Deploy & Monitor', duration: '05:50', src: 'Videos/sample4.mp4', desc: 'Shipping models.' } ] } ] } }; const COURSE = COURSE_LIBRARY[courseName] || { instructor: 'Instructor', sections: [{ title: 'Section 1', lessons: [{ id: 'demo-1', title: 'Welcome', duration: '02:00', src: 'Videos/sample1.mp4', desc: 'Demo lesson.' }] }] }; document.getElementById('courseTitle').textContent = courseName; document.getElementById('sidebarCourseName').textContent = courseName; document.getElementById('sidebarInstructor').textContent = COURSE.instructor || 'â€”'; document.getElementById('userPill').textContent = username; const flatLessons = COURSE.sections.flatMap((sec, si) => sec.lessons.map((l, li) => ({ ...l, sectionIndex: si, lessonIndex: li }))); document.getElementById('sidebarCount').textContent = flatLessons.length; const curriculumRoot = document.getElementById('curriculum'); COURSE.sections.forEach((section, si) => { const secEl = document.createElement('div'); secEl.className = 'section'; const head = document.createElement('div'); head.className = 'section-header'; head.innerHTML = `<span>${si + 1}. ${section.title}</span><span>â–¼</span>`; secEl.appendChild(head); const list = document.createElement('div'); list.className = 'lessons'; section.lessons.forEach((lesson) => { const globalIndex = flatLessons.findIndex(f => f.id === lesson.id); const item = document.createElement('div'); item.className = 'lesson'; item.dataset.lessonId = lesson.id; item.dataset.globalIndex = globalIndex; item.innerHTML = ` <div class="index">${globalIndex + 1}.</div> <div class="title">${lesson.title}</div> <div class="duration">${lesson.duration}</div> <div class="state">Locked</div> `; list.appendChild(item); }); secEl.appendChild(list); curriculumRoot.appendChild(secEl); head.addEventListener('click', () => { list.style.display = (list.style.display === 'none') ? 'grid' : 'none'; }); }); function loadProgress() { try { const raw = localStorage.getItem(STORAGE_KEY(courseName)); if (!raw) return { completed: new Set(), lastIndex: 0 }; const parsed = JSON.parse(raw); return { completed: new Set(parsed.completed || []), lastIndex: Math.max(0, Math.min(parsed.lastIndex ?? 0, flatLessons.length - 1)) }; } catch { return { completed: new Set(), lastIndex: 0 }; } } 
                
              function saveProgress(state) {
localStorage.setItem(
STORAGE_KEY(courseName),
JSON.stringify({
completed: Array.from(state.completed),
lastIndex: state.lastIndex,
total: flatLessons.length
})
);
}
                    
                    const state = loadProgress();
                    saveProgress(state); // ensures { total } exists for index page


function isUnlocked(index) { if (index === 0) return true; const prevId = flatLessons[index - 1].id; return state.completed.has(prevId); } function markCompletedByIndex(index) { state.completed.add(flatLessons[index].id); if (state.lastIndex < index) state.lastIndex = index; saveProgress(state); refreshUI();
   if (state.completed.size === flatLessons.length) {
document.getElementById('certificateArea').style.display = 'flex';
localStorage.setItem('lxLastCompletedCourse', courseName); // add this
} } function refreshUI(activeIndex = currentIndex) { $$('.lesson').forEach(el => { const idx = Number(el.dataset.globalIndex); const id = flatLessons[idx].id; el.classList.remove('active', 'locked', 'completed'); const badge = el.querySelector('.state'); if (state.completed.has(id)) { el.classList.add('completed'); badge.textContent = 'Done'; } else if (!isUnlocked(idx)) { el.classList.add('locked'); badge.textContent = 'Locked'; } else { badge.textContent = 'Open'; } if (idx === activeIndex) { el.classList.add('active'); } }); const pct = Math.round((state.completed.size / flatLessons.length) * 100); document.getElementById('progressText').textContent = pct + '%'; document.getElementById('progressFill').style.width = pct + '%'; } let currentIndex = Math.max(0, Math.min(state.lastIndex, flatLessons.length - 1)); 

function loadLesson(index) {
currentIndex = index;
const lesson = flatLessons[index];
const video = document.getElementById('video');

document.getElementById('lessonTitle').textContent = lesson.title;
document.getElementById('lessonDesc').textContent = lesson.desc || '';

// Temporary debug
// console.log('Loading lesson:', lesson);
// console.log('Resolved src:', lesson.src);

video.src = lesson.src;
video.currentTime = 0;
video.style.display = 'block';
video.play().catch(() => {});

if (state.lastIndex < index) {
state.lastIndex = index;
saveProgress(state);
}
refreshUI(index);
}




 $$('.lesson').forEach(el => { el.addEventListener('click', () => { const idx = Number(el.dataset.globalIndex); if (!isUnlocked(idx)) { alert('Please complete the previous lesson before proceeding.'); return; } loadLesson(idx); }); }); document.getElementById('video').addEventListener('ended', () => { markCompletedByIndex(currentIndex); const next = currentIndex + 1; if (next >= flatLessons.length) { document.getElementById('certificateArea').style.display = 'flex'; } }); document.getElementById('prevBtn').addEventListener('click', () => { const prev = currentIndex - 1; if (prev >= 0) loadLesson(prev); }); document.getElementById('nextBtn').addEventListener('click', () => { const next = currentIndex + 1; if (next >= flatLessons.length) return; if (!isUnlocked(next)) { alert('Please complete the previous lesson before proceeding.'); return; } loadLesson(next); }); 
 
 
document.getElementById('downloadCertBtn').addEventListener('click', () => {
  const name = localStorage.getItem('lxUserName') || 'Learner';
  const course = courseName;
  localStorage.setItem('lxLastCompletedCourse', course);
  const url = 'certificate.html?name=' + encodeURIComponent(name) + '&course=' + encodeURIComponent(course) + '&auto=1';
  window.location.href = url;
});

 
 if (!isUnlocked(0)) { state.completed.clear(); state.lastIndex = 0; saveProgress(state); } loadLesson(currentIndex); refreshUI(currentIndex); 



</script> 

</body>


</html>
